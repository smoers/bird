/*
Class Modal
Pour l'affichage de la fenêtre Modal
 */

/**
 * Class destinée à l'affichage de la fenetre modal avec les messages
 * Cette classe va de pair avec les tags
 */
class Modal{

    /**
     * Contructeur
     */
    constructor(){
        //Valeur par default
        this._index = 0;
        this._button = new Array();
        this._glyphicon = '<span class="glyphicon glyphicon-question-sign">';
        this._title = '</span>';
        this._content = 'Message Content';
        this._maskFooter = '';
        this._footer = '<button type="button" class="btn btn-default" data-dismiss="modal" id="modalMessage_'+ this._index +'">Close</button>';
        this._col = 13;
    }

    /**
     * Permet d'ajouter un titre à la suite du Glyphicon
     * @param value
     */
    addTitle(value){
        this._title = '  ' + value + '</span>';
    }

    /**
     * Permet d'ajouter le contenu du message
     * @param value
     */
    addContent(value){
        this._content = value;
    }

    /**
     * Permet d'ajouter un element avec ses tag HTML ex : un <select></select>
     * @param value
     */
    addHTMLElement(value){
        this._button.push(value);
        this.calBootstrapColumn();
    }

    /**
     * Permet d'ajouter un bouton dans le Footer
     * Un index est incrémenté a chaque ajout d'un bouton
     * L'ordre d'affichage correspond à l'ordre d'ajout des boutons.
     * @param value
     */
    addButton(value){
        this._button.push('<button type="button" class="btn btn-default" data-dismiss="modal" id="modalMessage_'+ this._index +'">' + value + '</button>');
        this.calBootstrapColumn();
        this._index++;
    }

    /**
     * Permet de définir un mask pour l'affichage des elements du footer.
     *
     * @param value
     */
    addMaskFooter(value){
        this._maskFooter = value;
    }

    calBootstrapColumn(){
        if(this._col >= 4){
            this._col--;
        }
    }

    glyphicon(value){
        switch (value){
            case 'question': this._glyphicon = '<span class="glyphicon glyphicon-question-sign text-primary">'; break;
            case 'warning' : this._glyphicon = '<span class="glyphicon glyphicon-warning-sign text-warning">'; break;
            case 'info' : this._glyphicon = '<span class="glyphicon glyphicon-info-sign text-info">'; break;
            case 'ok' : this._glyphicon = '<span class="glyphicon glyphicon-ok-sign text-success">'; break;
        }
    }

    get bootstrapColumn(){
        return this._col;
    }

    get button(){
        return this._button;
    }

    show(){
        //Construire le footer
        var mask = '';
        if(this._maskFooter !== ''){
            mask = this._maskFooter;
            this._button.forEach(function(item, index, array){
                mask = mask.replace('%%'+index+'%%',item);
            });
            mask = mask.replace(/%%\d+%%/g, '');
        }
        else{
            mask = '<div class="row">';
            this._button.forEach(function(item, index, array) {
                mask = mask + '<div class="col-md-'+ this.bootstrapColumn +' text-right">' + item + '</div>';
            },this);
            mask = mask + '</div>'
        }
        $('#modalMessages_title').html(this._glyphicon + this._title);
        $('#modalMessages_content').html(this._content);
        $('#modalMessages_footer').html(mask);
        $('#modalMessages').modal('show');
    }

}